<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Professional Salon Client Form</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Signature Pad Library -->
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    
    <style>
        :root {
            --primary-color: #8B5CF6;
            --primary-dark: #7C3AED;
            --accent-color: #F59E0B;
            --text-color: #374151;
            --light-bg: #F8FAFC;
            --border-color: #E5E7EB;
            --success-color: #10B981;
            --error-color: #EF4444;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--light-bg) 0%, #EDE9FE 100%);
            color: var(--text-color);
            min-height: 100vh;
        }

        .form-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.1);
            overflow: hidden;
            margin: 2rem 0;
        }

        .form-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 2.5rem 2rem;
            text-align: center;
        }

        .form-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-header p {
            font-size: 1.1rem;
            opacity: 0.95;
            margin: 0;
        }

        .form-body {
            padding: 3rem 2rem;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .step {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--border-color);
            color: #6B7280;
            font-weight: 600;
            margin: 0 1rem;
            position: relative;
            transition: all 0.3s ease;
        }

        .step.active {
            background: var(--primary-color);
            color: white;
        }

        .step.completed {
            background: var(--success-color);
            color: white;
        }

        .step::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: 2rem;
            height: 2px;
            background: var(--border-color);
            transform: translateY(-50%);
        }

        .step:last-child::after {
            display: none;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }

        .section-title {
            color: var(--primary-color);
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-control, .form-select {
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 0.875rem 1rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(139, 92, 246, 0.25);
            outline: none;
        }

        .form-label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        .signature-container {
            border: 2px dashed var(--border-color);
            border-radius: 15px;
            padding: 1rem;
            text-align: center;
            background: white;
            transition: all 0.3s ease;
        }

        .signature-container.active {
            border-color: var(--primary-color);
            background: #F8F5FF;
        }

        #signature-canvas {
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: crosshair;
            width: 100%;
            height: 200px;
            display: block;
            background: white;
        }

        .signature-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            padding: 0.875rem 1.5rem;
            transition: all 0.3s ease;
            border: none;
            text-transform: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-outline-primary {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--accent-color);
            color: white;
        }

        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover {
            border-color: var(--primary-color);
            background: #F8F5FF;
        }

        .file-upload-area.dragover {
            border-color: var(--primary-color);
            background: #F0F9FF;
            transform: scale(1.02);
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .form-navigation {
            display: flex;
            justify-content: between;
            align-items: center;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
        }

        .progress-container {
            margin-bottom: 2rem;
        }

        .progress {
            height: 8px;
            background: var(--border-color);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
            transition: width 0.5s ease;
        }

        .consent-section {
            background: #FEF3C7;
            border: 1px solid #F59E0B;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .form-check {
            margin: 1rem 0;
        }

        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }

        .toast {
            border-radius: 12px;
            border: none;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .invalid-feedback {
            display: block;
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .is-invalid {
            border-color: var(--error-color);
        }

        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .form-body {
                padding: 2rem 1.5rem;
            }
            
            .form-header {
                padding: 2rem 1.5rem;
            }
            
            .form-header h1 {
                font-size: 2rem;
            }
            
            .form-section {
                padding: 1.5rem;
            }
            
            .signature-controls {
                flex-direction: column;
            }
            
            .form-navigation {
                flex-direction: column;
                gap: 1rem;
            }

            #signature-canvas {
                height: 150px;
            }
        }

        @media (max-width: 480px) {
            .step-indicator {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .step {
                width: 35px;
                height: 35px;
                margin: 0 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container"></div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10 col-xl-8">
                <div class="form-container">
                    <!-- Form Header -->
                    <div class="form-header">
                        <h1><i class="fas fa-scissors me-3"></i>Salon Client Form</h1>
                        <p>Complete your service details and consultation information</p>
                    </div>

                    <!-- Form Body -->
                    <div class="form-body">
                        <!-- Progress Bar -->
                        <div class="progress-container">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" style="width: 20%"></div>
                            </div>
                            <small class="text-muted mt-2 d-block text-center">Step <span id="current-step">1</span> of 5</small>
                        </div>

                        <!-- Step Indicator -->
                        <div class="step-indicator">
                            <div class="step active" data-step="1">1</div>
                            <div class="step" data-step="2">2</div>
                            <div class="step" data-step="3">3</div>
                            <div class="step" data-step="4">4</div>
                            <div class="step" data-step="5">5</div>
                        </div>

                        <!-- Main Form -->
                        <form id="salon-form" novalidate>
                            <!-- Step 1: Client Information -->
                            <div class="form-step active" data-step="1">
                                <div class="form-section">
                                    <h3 class="section-title">
                                        <i class="fas fa-user"></i>
                                        Client Information
                                    </h3>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="clientName" class="form-label">Full Name *</label>
                                            <input type="text" class="form-control" id="clientName" name="clientName" required>
                                            <div class="invalid-feedback">Please provide a valid name.</div>
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="phone" class="form-label">Phone Number *</label>
                                            <input type="tel" class="form-control" id="phone" name="phone" required>
                                            <div class="invalid-feedback">Please provide a valid phone number.</div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="email" class="form-label">Email Address *</label>
                                            <input type="email" class="form-control" id="email" name="email" required>
                                            <div class="invalid-feedback">Please provide a valid email address.</div>
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="visitDate" class="form-label">Visit Date *</label>
                                            <input type="date" class="form-control" id="visitDate" name="visitDate" required>
                                            <div class="invalid-feedback">Please select a visit date.</div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="clientType" class="form-label">Client Type *</label>
                                        <select class="form-select" id="clientType" name="clientType" required>
                                            <option value="">Select client type</option>
                                            <option value="new">New Client</option>
                                            <option value="returning">Returning Client</option>
                                            <option value="referral">Referral</option>
                                        </select>
                                        <div class="invalid-feedback">Please select a client type.</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Service Details -->
                            <div class="form-step" data-step="2">
                                <div class="form-section">
                                    <h3 class="section-title">
                                        <i class="fas fa-cut"></i>
                                        Service Details
                                    </h3>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Services Required *</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="haircut" id="service1" name="services">
                                                    <label class="form-check-label" for="service1">Haircut</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="coloring" id="service2" name="services">
                                                    <label class="form-check-label" for="service2">Hair Coloring</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="styling" id="service3" name="services">
                                                    <label class="form-check-label" for="service3">Hair Styling</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="treatment" id="service4" name="services">
                                                    <label class="form-check-label" for="service4">Hair Treatment</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="highlights" id="service5" name="services">
                                                    <label class="form-check-label" for="service5">Highlights</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="perm" id="service6" name="services">
                                                    <label class="form-check-label" for="service6">Perm</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="manicure" id="service7" name="services">
                                                    <label class="form-check-label" for="service7">Manicure</label>
                                                </div>
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" value="facial" id="service8" name="services">
                                                    <label class="form-check-label" for="service8">Facial</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="invalid-feedback">Please select at least one service.</div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="totalCost" class="form-label">Total Service Cost (₹) *</label>
                                        <input type="number" class="form-control" id="totalCost" name="totalCost" min="0" step="0.01" required>
                                        <div class="invalid-feedback">Please enter the total cost.</div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="serviceNotes" class="form-label">Service Notes</label>
                                        <textarea class="form-control" id="serviceNotes" name="serviceNotes" rows="3" placeholder="Any special instructions or notes about the service..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Hair Analysis -->
                            <div class="form-step" data-step="3">
                                <div class="form-section">
                                    <h3 class="section-title">
                                        <i class="fas fa-search"></i>
                                        Hair Analysis & Health
                                    </h3>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="hairType" class="form-label">Hair Type</label>
                                            <select class="form-select" id="hairType" name="hairType">
                                                <option value="">Select hair type</option>
                                                <option value="straight">Straight</option>
                                                <option value="wavy">Wavy</option>
                                                <option value="curly">Curly</option>
                                                <option value="coily">Coily</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="hairTexture" class="form-label">Hair Texture</label>
                                            <select class="form-select" id="hairTexture" name="hairTexture">
                                                <option value="">Select hair texture</option>
                                                <option value="fine">Fine</option>
                                                <option value="medium">Medium</option>
                                                <option value="thick">Thick</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="scalpCondition" class="form-label">Scalp Condition</label>
                                        <select class="form-select" id="scalpCondition" name="scalpCondition">
                                            <option value="">Select scalp condition</option>
                                            <option value="normal">Normal</option>
                                            <option value="oily">Oily</option>
                                            <option value="dry">Dry</option>
                                            <option value="sensitive">Sensitive</option>
                                            <option value="dandruff">Dandruff</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label for="previousTreatments" class="form-label">Previous Treatments</label>
                                        <textarea class="form-control" id="previousTreatments" name="previousTreatments" rows="2" placeholder="Any previous chemical treatments, colors, or procedures..."></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label for="allergies" class="form-label">Known Allergies</label>
                                        <textarea class="form-control" id="allergies" name="allergies" rows="2" placeholder="Any known allergies to hair products or chemicals..."></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label for="clientExpectations" class="form-label">Client Expectations</label>
                                        <textarea class="form-control" id="clientExpectations" name="clientExpectations" rows="3" placeholder="What are you hoping to achieve with today's service?"></textarea>
                                    </div>

                                    <!-- Before Photo Upload -->
                                    <div class="mb-3">
                                        <label class="form-label">Before Photo (Optional)</label>
                                        <div class="file-upload-area" onclick="document.getElementById('beforePhoto').click()">
                                            <input type="file" id="beforePhoto" name="beforePhoto" accept="image/*" style="display: none;">
                                            <i class="fas fa-camera fa-3x mb-3 text-muted"></i>
                                            <p class="mb-0">Click to upload or drag and drop a photo</p>
                                            <small class="text-muted">PNG, JPG up to 5MB</small>
                                        </div>
                                        <div id="beforePhotoPreview"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 4: Products & Stylists -->
                            <div class="form-step" data-step="4">
                                <div class="form-section">
                                    <h3 class="section-title">
                                        <i class="fas fa-palette"></i>
                                        Products & Stylists
                                    </h3>
                                    
                                    <div id="product-section">
                                        <div class="product-row mb-4 p-3 border rounded">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Product Name</label>
                                                    <input type="text" class="form-control" name="productName" placeholder="e.g., L'Oreal Professional">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Product Type</label>
                                                    <select class="form-select" name="productType">
                                                        <option value="">Select product type</option>
                                                        <option value="shampoo">Shampoo</option>
                                                        <option value="conditioner">Conditioner</option>
                                                        <option value="color">Hair Color</option>
                                                        <option value="treatment">Treatment</option>
                                                        <option value="styling">Styling Product</option>
                                                        <option value="other">Other</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <label class="form-label">Quantity Used</label>
                                                    <input type="number" class="form-control" name="quantityUsed" min="0" step="0.1">
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <label class="form-label">Unit</label>
                                                    <select class="form-select" name="unit">
                                                        <option value="">Select unit</option>
                                                        <option value="ml">ml</option>
                                                        <option value="grams">grams</option>
                                                        <option value="pieces">pieces</option>
                                                        <option value="tubes">tubes</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-4 mb-3 d-flex align-items-end">
                                                    <button type="button" class="btn btn-outline-danger remove-product" style="display: none;">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button type="button" id="add-product" class="btn btn-outline-primary mb-4">
                                        <i class="fas fa-plus"></i> Add Another Product
                                    </button>

                                    <div id="stylist-section">
                                        <div class="stylist-row mb-4 p-3 border rounded">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Stylist Name</label>
                                                    <input type="text" class="form-control" name="stylistName" placeholder="e.g., Maria Silva">
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <label class="form-label">Incentive Split (₹)</label>
                                                    <input type="number" class="form-control" name="incentiveSplit" min="0" step="0.01">
                                                </div>
                                                <div class="col-md-2 mb-3 d-flex align-items-end">
                                                    <button type="button" class="btn btn-outline-danger remove-stylist" style="display: none;">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button type="button" id="add-stylist" class="btn btn-outline-primary">
                                        <i class="fas fa-plus"></i> Add Another Stylist
                                    </button>
                                </div>
                            </div>

                            <!-- Step 5: Consent & Signature -->
                            <div class="form-step" data-step="5">
                                <div class="form-section">
                                    <h3 class="section-title">
                                        <i class="fas fa-file-signature"></i>
                                        Consent & Digital Signature
                                    </h3>
                                    
                                    <!-- Consent Section -->
                                    <div class="consent-section">
                                        <h5 class="text-warning mb-3">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            Important Consent Information
                                        </h5>
                                        
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="consent1" name="consent" value="service" required>
                                            <label class="form-check-label" for="consent1">
                                                I consent to receive the selected services and understand the potential risks involved.
                                            </label>
                                        </div>
                                        
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="consent2" name="consent" value="allergy" required>
                                            <label class="form-check-label" for="consent2">
                                                I have disclosed all known allergies and medical conditions that may affect the service.
                                            </label>
                                        </div>
                                        
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="consent3" name="consent" value="photos" required>
                                            <label class="form-check-label" for="consent3">
                                                I consent to photographs being taken for record-keeping purposes.
                                            </label>
                                        </div>
                                        
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="consent4" name="consent" value="data" required>
                                            <label class="form-check-label" for="consent4">
                                                I agree to the salon's privacy policy and data handling practices.
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Digital Signature -->
                                    <div class="signature-container">
                                        <label class="form-label">Digital Signature *</label>
                                        <p class="text-muted mb-3">Please sign below using your mouse, finger, or stylus</p>
                                        
                                        <canvas id="signature-canvas" width="600" height="200"></canvas>
                                        
                                        <div class="signature-controls">
                                            <button type="button" id="clear-signature" class="btn btn-outline-warning">
                                                <i class="fas fa-eraser"></i> Clear
                                            </button>
                                            <button type="button" id="undo-signature" class="btn btn-outline-secondary">
                                                <i class="fas fa-undo"></i> Undo
                                            </button>
                                        </div>
                                        <div class="invalid-feedback">Please provide your digital signature.</div>
                                    </div>

                                    <!-- Satisfaction & Follow-up -->
                                    <div class="mt-4">
                                        <div class="mb-3">
                                            <label for="clientSatisfaction" class="form-label">Expected Satisfaction Level</label>
                                            <select class="form-select" id="clientSatisfaction" name="clientSatisfaction">
                                                <option value="">Rate your expectation</option>
                                                <option value="1">1 - Basic Service</option>
                                                <option value="2">2 - Good Service</option>
                                                <option value="3">3 - Great Service</option>
                                                <option value="4">4 - Excellent Service</option>
                                                <option value="5">5 - Outstanding Service</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="followUp" class="form-label">Follow-up Preferences</label>
                                            <textarea class="form-control" id="followUp" name="followUp" rows="2" placeholder="When would you like us to contact you for follow-up?"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Navigation Buttons -->
                            <div class="form-navigation">
                                <button type="button" id="prev-btn" class="btn btn-outline-primary" style="display: none;">
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                
                                <div class="ms-auto">
                                    <button type="button" id="next-btn" class="btn btn-primary">
                                        Next <i class="fas fa-arrow-right"></i>
                                    </button>
                                    <button type="submit" id="submit-btn" class="btn btn-success" style="display: none;">
                                        <span id="submit-spinner" class="spinner-border spinner-border-sm d-none me-2"></span>
                                        <i class="fas fa-check me-2"></i> Submit Form
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <script>
        // Configuration
        const CONFIG = {
            APPS_SCRIPT_URL: 'YOUR_APPS_SCRIPT_URL_HERE', // Replace with your actual URL
            MAX_FILE_SIZE: 5 * 1024 * 1024, // 5MB
            ALLOWED_FILE_TYPES: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif']
        };

        // Form Management Class
        class SalonForm {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 5;
                this.signaturePad = null;
                this.beforePhotoData = null;
                
                this.init();
            }

            init() {
                this.initializeSignaturePad();
                this.setupEventListeners();
                this.setupFileUpload();
                this.setupDynamicFields();
                this.updateStepIndicator();
            }

            // Initialize Signature Pad with touch support[29][46][51]
            initializeSignaturePad() {
                const canvas = document.getElementById('signature-canvas');
                if (!canvas) return;

                this.signaturePad = new SignaturePad(canvas, {
                    backgroundColor: 'rgba(255, 255, 255, 1)',
                    penColor: 'rgb(0, 0, 0)',
                    minWidth: 0.5,
                    maxWidth: 2.5,
                    throttle: 16,
                    minDistance: 5,
                });

                // Make responsive
                this.resizeSignatureCanvas();
                window.addEventListener('resize', () => this.resizeSignatureCanvas());

                // Clear signature button
                document.getElementById('clear-signature').addEventListener('click', () => {
                    this.signaturePad.clear();
                });

                // Undo signature button
                document.getElementById('undo-signature').addEventListener('click', () => {
                    const data = this.signaturePad.toData();
                    if (data && data.length > 0) {
                        data.pop();
                        this.signaturePad.fromData(data);
                    }
                });

                // Visual feedback when signing
                this.signaturePad.addEventListener('beginStroke', () => {
                    document.querySelector('.signature-container').classList.add('active');
                });
            }

            // Make signature canvas responsive[38][54]
            resizeSignatureCanvas() {
                const canvas = document.getElementById('signature-canvas');
                if (!canvas || !this.signaturePad) return;

                const ratio = Math.max(window.devicePixelRatio || 1, 1);
                const rect = canvas.getBoundingClientRect();
                
                canvas.width = rect.width * ratio;
                canvas.height = rect.height * ratio;
                canvas.getContext('2d').scale(ratio, ratio);
                
                this.signaturePad.clear(); // Unfortunately, we need to clear on resize
            }

            // Setup all event listeners[41][42][45]
            setupEventListeners() {
                // Navigation buttons
                document.getElementById('next-btn').addEventListener('click', () => this.nextStep());
                document.getElementById('prev-btn').addEventListener('click', () => this.prevStep());
                
                // Form submission
                document.getElementById('salon-form').addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Real-time validation
                this.setupRealTimeValidation();
                
                // Service checkboxes
                this.setupServiceValidation();
            }

            // Setup real-time validation[42][48][50]
            setupRealTimeValidation() {
                const inputs = document.querySelectorAll('input[required], select[required], textarea[required]');
                
                inputs.forEach(input => {
                    input.addEventListener('blur', () => this.validateField(input));
                    input.addEventListener('input', () => this.clearFieldError(input));
                });

                // Email validation
                document.getElementById('email').addEventListener('input', (e) => {
                    const email = e.target;
                    if (email.value && !this.isValidEmail(email.value)) {
                        this.showFieldError(email, 'Please enter a valid email address.');
                    } else {
                        this.clearFieldError(email);
                    }
                });

                // Phone validation
                document.getElementById('phone').addEventListener('input', (e) => {
                    const phone = e.target;
                    if (phone.value && !this.isValidPhone(phone.value)) {
                        this.showFieldError(phone, 'Please enter a valid phone number.');
                    } else {
                        this.clearFieldError(phone);
                    }
                });
            }

            // Setup service validation
            setupServiceValidation() {
                const serviceCheckboxes = document.querySelectorAll('input[name="services"]');
                serviceCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        const isAnyChecked = Array.from(serviceCheckboxes).some(cb => cb.checked);
                        serviceCheckboxes.forEach(cb => {
                            if (isAnyChecked) {
                                cb.setCustomValidity('');
                                this.clearFieldError(cb);
                            }
                        });
                    });
                });
            }

            // Setup file upload with drag & drop[3][6][15]
            setupFileUpload() {
                const uploadArea = document.querySelector('.file-upload-area');
                const fileInput = document.getElementById('beforePhoto');

                // Click to upload
                fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // Drag and drop
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });

                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.classList.remove('dragover');
                });

                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.processFile(files[0]);
                    }
                });
            }

            // Handle file selection and convert to base64[6][15]
            handleFileSelect(e) {
                const file = e.target.files[0];
                if (file) {
                    this.processFile(file);
                }
            }

            // Process file and convert to base64[6][15]
            processFile(file) {
                // Validate file type
                if (!CONFIG.ALLOWED_FILE_TYPES.includes(file.type)) {
                    this.showToast('Invalid file type. Please select a JPEG, PNG, or GIF image.', 'error');
                    return;
                }

                // Validate file size
                if (file.size > CONFIG.MAX_FILE_SIZE) {
                    this.showToast('File size too large. Please select an image under 5MB.', 'error');
                    return;
                }

                // Convert to base64
                const reader = new FileReader();
                reader.onload = (e) => {
                    this.beforePhotoData = e.target.result;
                    this.showPhotoPreview(e.target.result);
                };
                reader.readAsDataURL(file);
            }

            // Show photo preview
            showPhotoPreview(dataUrl) {
                const preview = document.getElementById('beforePhotoPreview');
                preview.innerHTML = `
                    <div class="mt-3">
                        <img src="${dataUrl}" class="preview-image" alt="Before photo preview">
                        <div class="mt-2">
                            <button type="button" class="btn btn-sm btn-outline-danger" onclick="salonForm.removePhoto()">
                                <i class="fas fa-trash"></i> Remove Photo
                            </button>
                        </div>
                    </div>
                `;
            }

            // Remove photo
            removePhoto() {
                this.beforePhotoData = null;
                document.getElementById('beforePhoto').value = '';
                document.getElementById('beforePhotoPreview').innerHTML = '';
            }

            // Setup dynamic product and stylist fields
            setupDynamicFields() {
                // Add product button
                document.getElementById('add-product').addEventListener('click', () => {
                    this.addProductRow();
                });

                // Add stylist button
                document.getElementById('add-stylist').addEventListener('click', () => {
                    this.addStylistRow();
                });
            }

            // Add product row
            addProductRow() {
                const section = document.getElementById('product-section');
                const newRow = document.createElement('div');
                newRow.className = 'product-row mb-4 p-3 border rounded';
                newRow.innerHTML = `
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Product Name</label>
                            <input type="text" class="form-control" name="productName" placeholder="e.g., L'Oreal Professional">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Product Type</label>
                            <select class="form-select" name="productType">
                                <option value="">Select product type</option>
                                <option value="shampoo">Shampoo</option>
                                <option value="conditioner">Conditioner</option>
                                <option value="color">Hair Color</option>
                                <option value="treatment">Treatment</option>
                                <option value="styling">Styling Product</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Quantity Used</label>
                            <input type="number" class="form-control" name="quantityUsed" min="0" step="0.1">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Unit</label>
                            <select class="form-select" name="unit">
                                <option value="">Select unit</option>
                                <option value="ml">ml</option>
                                <option value="grams">grams</option>
                                <option value="pieces">pieces</option>
                                <option value="tubes">tubes</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3 d-flex align-items-end">
                            <button type="button" class="btn btn-outline-danger remove-product">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;

                section.appendChild(newRow);
                
                // Add remove functionality
                newRow.querySelector('.remove-product').addEventListener('click', () => {
                    newRow.remove();
                });

                // Show remove buttons on all rows
                document.querySelectorAll('.remove-product').forEach(btn => {
                    btn.style.display = 'block';
                });
            }

            // Add stylist row
            addStylistRow() {
                const section = document.getElementById('stylist-section');
                const newRow = document.createElement('div');
                newRow.className = 'stylist-row mb-4 p-3 border rounded';
                newRow.innerHTML = `
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Stylist Name</label>
                            <input type="text" class="form-control" name="stylistName" placeholder="e.g., Maria Silva">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Incentive Split (₹)</label>
                            <input type="number" class="form-control" name="incentiveSplit" min="0" step="0.01">
                        </div>
                        <div class="col-md-2 mb-3 d-flex align-items-end">
                            <button type="button" class="btn btn-outline-danger remove-stylist">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;

                section.appendChild(newRow);
                
                // Add remove functionality
                newRow.querySelector('.remove-stylist').addEventListener('click', () => {
                    newRow.remove();
                });

                // Show remove buttons on all rows
                document.querySelectorAll('.remove-stylist').forEach(btn => {
                    btn.style.display = 'block';
                });
            }

            // Navigation methods
            nextStep() {
                if (this.validateCurrentStep()) {
                    if (this.currentStep < this.totalSteps) {
                        this.currentStep++;
                        this.updateStepDisplay();
                    }
                }
            }

            prevStep() {
                if (this.currentStep > 1) {
                    this.currentStep--;
                    this.updateStepDisplay();
                }
            }

            // Update step display and progress
            updateStepDisplay() {
                // Hide all steps
                document.querySelectorAll('.form-step').forEach(step => {
                    step.classList.remove('active');
                });

                // Show current step
                document.querySelector(`[data-step="${this.currentStep}"]`).classList.add('active');

                // Update progress bar
                const progress = (this.currentStep / this.totalSteps) * 100;
                document.querySelector('.progress-bar').style.width = `${progress}%`;
                document.getElementById('current-step').textContent = this.currentStep;

                // Update step indicator
                this.updateStepIndicator();

                // Update navigation buttons
                this.updateNavigationButtons();

                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            updateStepIndicator() {
                document.querySelectorAll('.step').forEach((step, index) => {
                    const stepNum = index + 1;
                    step.classList.remove('active', 'completed');
                    
                    if (stepNum < this.currentStep) {
                        step.classList.add('completed');
                    } else if (stepNum === this.currentStep) {
                        step.classList.add('active');
                    }
                });
            }

            updateNavigationButtons() {
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');
                const submitBtn = document.getElementById('submit-btn');

                // Previous button
                prevBtn.style.display = this.currentStep > 1 ? 'block' : 'none';

                // Next/Submit button
                if (this.currentStep < this.totalSteps) {
                    nextBtn.style.display = 'block';
                    submitBtn.style.display = 'none';
                } else {
                    nextBtn.style.display = 'none';
                    submitBtn.style.display = 'block';
                }
            }

            // Validation methods[42][45][50]
            validateCurrentStep() {
                const currentStepElement = document.querySelector(`[data-step="${this.currentStep}"]`);
                const requiredFields = currentStepElement.querySelectorAll('[required]');
                let isValid = true;

                requiredFields.forEach(field => {
                    if (!this.validateField(field)) {
                        isValid = false;
                    }
                });

                // Special validations
                if (this.currentStep === 2) {
                    // Validate at least one service is selected
                    const serviceCheckboxes = document.querySelectorAll('input[name="services"]');
                    const isAnyServiceSelected = Array.from(serviceCheckboxes).some(cb => cb.checked);
                    
                    if (!isAnyServiceSelected) {
                        this.showFieldError(serviceCheckboxes[0], 'Please select at least one service.');
                        isValid = false;
                    }
                }

                if (this.currentStep === 5) {
                    // Validate signature
                    if (!this.signaturePad || this.signaturePad.isEmpty()) {
                        this.showFieldError(document.getElementById('signature-canvas'), 'Please provide your digital signature.');
                        isValid = false;
                    }

                    // Validate consent checkboxes
                    const consentCheckboxes = document.querySelectorAll('input[name="consent"]');
                    const allConsentsGiven = Array.from(consentCheckboxes).every(cb => cb.checked);
                    
                    if (!allConsentsGiven) {
                        consentCheckboxes.forEach(cb => {
                            if (!cb.checked) {
                                this.showFieldError(cb, 'This consent is required.');
                            }
                        });
                        isValid = false;
                    }
                }

                return isValid;
            }

            validateField(field) {
                if (field.type === 'email' && field.value) {
                    if (!this.isValidEmail(field.value)) {
                        this.showFieldError(field, 'Please enter a valid email address.');
                        return false;
                    }
                }

                if (field.type === 'tel' && field.value) {
                    if (!this.isValidPhone(field.value)) {
                        this.showFieldError(field, 'Please enter a valid phone number.');
                        return false;
                    }
                }

                if (field.hasAttribute('required')) {
                    if (field.type === 'checkbox') {
                        if (!field.checked) {
                            this.showFieldError(field, 'This field is required.');
                            return false;
                        }
                    } else if (!field.value.trim()) {
                        this.showFieldError(field, 'This field is required.');
                        return false;
                    }
                }

                this.clearFieldError(field);
                return true;
            }

            showFieldError(field, message) {
                field.classList.add('is-invalid');
                const feedback = field.parentElement.querySelector('.invalid-feedback');
                if (feedback) {
                    feedback.textContent = message;
                    feedback.style.display = 'block';
                }
            }

            clearFieldError(field) {
                field.classList.remove('is-invalid');
                const feedback = field.parentElement.querySelector('.invalid-feedback');
                if (feedback) {
                    feedback.style.display = 'none';
                }
            }

            // Utility validation methods
            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            isValidPhone(phone) {
                const phoneRegex = /^[\+]?[1-9][\d]{0,15}$/;
                return phoneRegex.test(phone.replace(/\s+/g, ''));
            }

            // Form submission with proper JSON formatting[2][5]
            async handleSubmit(e) {
                e.preventDefault();
                
                if (!this.validateCurrentStep()) {
                    return;
                }

                const submitBtn = document.getElementById('submit-btn');
                const spinner = document.getElementById('submit-spinner');
                
                // Show loading state
                submitBtn.disabled = true;
                spinner.classList.remove('d-none');

                try {
                    const formData = this.collectFormData();
                    console.log('Form data collected:', formData);

                    // Submit to Google Apps Script[2]
                    const response = await fetch(CONFIG.APPS_SCRIPT_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ formData })
                    });

                    const result = await response.json();
                    
                    if (response.ok) {
                        this.showToast('Form submitted successfully! Thank you for your submission.', 'success');
                        this.resetForm();
                    } else {
                        throw new Error(result.status || 'Submission failed');
                    }

                } catch (error) {
                    console.error('Submission error:', error);
                    this.showToast('There was an error submitting the form. Please try again.', 'error');
                } finally {
                    // Reset loading state
                    submitBtn.disabled = false;
                    spinner.classList.add('d-none');
                }
            }

            // Collect all form data including arrays and base64 images[8][11]
            collectFormData() {
                const formElement = document.getElementById('salon-form');
                const formData = new FormData(formElement);
                const data = {};

                // Basic form fields
                for (let [key, value] of formData.entries()) {
                    if (data[key]) {
                        if (Array.isArray(data[key])) {
                            data[key].push(value);
                        } else {
                            data[key] = [data[key], value];
                        }
                    } else {
                        data[key] = value;
                    }
                }

                // Handle checkbox arrays
                data.services = Array.from(document.querySelectorAll('input[name="services"]:checked'))
                    .map(cb => cb.value);

                data.consent = Array.from(document.querySelectorAll('input[name="consent"]:checked'))
                    .map(cb => cb.value);

                // Handle dynamic fields
                data.productName = Array.from(document.querySelectorAll('input[name="productName"]'))
                    .map(input => input.value).filter(val => val);

                data.productType = Array.from(document.querySelectorAll('select[name="productType"]'))
                    .map(select => select.value).filter(val => val);

                data.quantityUsed = Array.from(document.querySelectorAll('input[name="quantityUsed"]'))
                    .map(input => input.value).filter(val => val);

                data.unit = Array.from(document.querySelectorAll('select[name="unit"]'))
                    .map(select => select.value).filter(val => val);

                data.stylistName = Array.from(document.querySelectorAll('input[name="stylistName"]'))
                    .map(input => input.value).filter(val => val);

                data.incentiveSplit = Array.from(document.querySelectorAll('input[name="incentiveSplit"]'))
                    .map(input => input.value).filter(val => val);

                // Add signature data
                if (this.signaturePad && !this.signaturePad.isEmpty()) {
                    data.clientSignature = this.signaturePad.toDataURL();
                }

                // Add before photo data
                if (this.beforePhotoData) {
                    data.beforePhoto = this.beforePhotoData;
                }

                return data;
            }

            // Reset form after successful submission
            resetForm() {
                document.getElementById('salon-form').reset();
                this.signaturePad?.clear();
                this.beforePhotoData = null;
                document.getElementById('beforePhotoPreview').innerHTML = '';
                this.currentStep = 1;
                this.updateStepDisplay();
                
                // Reset dynamic fields
                document.querySelectorAll('.product-row:not(:first-child)').forEach(row => row.remove());
                document.querySelectorAll('.stylist-row:not(:first-child)').forEach(row => row.remove());
                document.querySelectorAll('.remove-product, .remove-stylist').forEach(btn => {
                    btn.style.display = 'none';
                });
            }

            // Toast notification system
            showToast(message, type = 'info') {
                const toastContainer = document.querySelector('.toast-container');
                const toastId = 'toast-' + Date.now();
                
                const toastHTML = `
                    <div id="${toastId}" class="toast align-items-center text-white bg-${type === 'error' ? 'danger' : type === 'success' ? 'success' : 'primary'} border-0" role="alert" aria-live="assertive" aria-atomic="true">
                        <div class="d-flex">
                            <div class="toast-body">
                                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                                ${message}
                            </div>
                            <button type="button" class="
